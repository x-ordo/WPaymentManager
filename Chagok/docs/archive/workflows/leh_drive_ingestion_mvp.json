{
  "name": "LEH – Drive Ingestion (MVP)",
  "nodes": [
    {
      "id": "Webhook_Trigger",
      "name": "Webhook: New Case",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [280, 300],
      "parameters": {
        "httpMethod": "POST",
        "path": "leh/drive-ingestion",
        "responseMode": "onReceived",
        "options": {
          "responseCode": 200,
          "responseBody": "LEH Drive ingestion workflow started"
        }
      },
      "webhookId": "leh-drive-ingestion-mvp"
    },
    {
      "id": "Function_Extract",
      "name": "Extract Payload",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [560, 300],
      "parameters": {
        "functionCode": "const body = items[0].json;\n\n// 기대 요청 형식\n// {\n//   \"caseId\": \"CASE-2025-0001\",\n//   \"driveUrl\": \"https://drive.google.com/drive/folders/...\",\n//   \"requestedBy\": \"lawyer@example.com\"\n// }\n\nreturn [{\n  json: {\n    caseId: body.caseId,\n    driveUrl: body.driveUrl,\n    requestedBy: body.requestedBy || null,\n    receivedAt: new Date().toISOString()\n  }\n}];"
      }
    },
    {
      "id": "HTTP_Backend",
      "name": "Notify Backend API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [840, 300],
      "parameters": {
        "url": "http://backend:8000/internal/ingestion/start",
        "method": "POST",
        "jsonParameters": true,
        "options": {},
        "bodyParametersJson": "={\n  \"case_id\": $json[\"caseId\"],\n  \"drive_url\": $json[\"driveUrl\"],\n  \"requested_by\": $json[\"requestedBy\"],\n  \"requested_at\": $json[\"receivedAt\"]\n}"
      }
    }
  ],
  "connections": {
    "Webhook_Trigger": {
      "main": [
        [
          {
            "node": "Extract Payload",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Payload": {
      "main": [
        [
          {
            "node": "Notify Backend API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "timezone": "Asia/Seoul",
    "saveDataSuccessExecution": "all"
  },
  "active": false,
  "id": "leh-drive-ingestion-mvp"
}
