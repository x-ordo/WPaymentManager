# Keypoint Tracking (증거 핵심포인트 추적) 설계

## 1) 정의
- **Evidence(증거)**: 파일/메시지/통화기록/사진/진단서/카드내역 등 '원천 자료'
- **Extract(발췌)**: 증거에서 특정 구간(페이지/시간/메시지 범위)을 지정한 '근거 조각'
- **Keypoint(핵심포인트, Fact Unit)**: 소송/협의서에 들어갈 수 있는 **원자적 사실 1개**  
  예: “2024-03-12 23:10, 배우자가 모텔 결제를 했다(카드내역 #A12).”

> 원칙: **파일은 증거의 컨테이너일 뿐**. 서비스의 핵심 데이터는 Keypoint다.

## 2) Keypoint의 품질 기준(서비스가 강제해야 함)
각 Keypoint는 최소한 아래 5요소를 갖추도록 UI에서 강제합니다.
1. **무엇(행위/사건)**: 외도/폭언/폭행/가출/생활비중단/채무발생 등
2. **언제(시간)**: 날짜(필수), 가능하면 시간(선택)
3. **누가(당사자/제3자)**: 배우자/본인/상간자/목격자 등
4. **무슨 근거(증거 링크)**: EvidenceExtract 1개 이상 연결
5. **법적 연결(요건 태깅)**: G1~G6 + (요건/입증포인트) 태그

## 3) 상태 머신(리뷰 프로세스)
- `DRAFT`: 임시 작성(추가 확인 필요)
- `READY`: 제출 후보(필수필드 충족 + 근거 연결 완료)
- `CONTESTED`: 반박/모순 발견(상대 주장 대비 필요)
- `EXCLUDED`: 사용하지 않기로 결정(중복/무관/위법수집 등)

## 4) 증거 → Extract → Keypoint 생성 플로우(UI)
detail/case 페이지에 아래 4개 탭을 전제로 합니다.
- **증거 정리 탭**: G1~G6 폴더 + 파일 상태(미검토/검토완료/적합/보류)
- **법적 근거 탭**: 각 G코드별 충족여부/커버리지(몇 개 Keypoint가 연결됨)
- **타임라인 뷰**: 사건 진행 + 이혼사유 발생 + 제소기간/신고기한 알림
- **초안 탭**: Keypoint를 문단 블록으로 드래그해 초안 구성

### UX 최소 동작
1) 증거 업로드 → 시스템이 **증거 유형 분류**(예: 카톡캡쳐/진단서/카드내역)
2) 유저가 하이라이트/페이지/시간구간 지정 → Extract 생성
3) Extract에서 “키포인트 만들기” → Keypoint 자동 생성(초안 템플릿)
4) 유저가 5요소(무엇/언제/누가/근거/법적연결)만 채우면 READY로 승격

## 5) 자동 추적(Tracking) 포인트
- **날짜/시간**: 타임라인 이벤트 자동 생성(중복 병합)
- **금액/계좌/상호**: 재산분할/위자료 산정 변수로 연결
- **장소**: 숙박업소/경찰서/병원 등 분류
- **커뮤니케이션**: ‘자백성 발언’, ‘부양 거부’, ‘협박/모욕’ 키워드 플래그
- **제척기간**: G1/G6처럼 “인지일/발생일” 입력 시 자동 계산(경고)

## 6) 안전/정합성 가드레일
- 허위 작성/증빙 조작을 돕는 기능 금지(제안/자동작성도 '추론' 표기)
- 불법 촬영·도청 등 위법수집 가능성 체크박스(리스크 태그) + 변호사 상담 유도
- 동일 사실 중복 Keypoint 자동 감지(날짜+사건+인물+증거 해시 기반)

