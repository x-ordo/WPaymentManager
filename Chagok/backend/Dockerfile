# backend/Dockerfile

FROM python:3.12-slim

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

WORKDIR /app

# psycopg2 등 DB 드라이버를 위한 기본 빌드 도구
RUN apt-get update && apt-get install -y --no-install-recommends \
    build-essential \
    libpq-dev \
 && apt-get clean \
 && rm -rf /var/lib/apt/lists/*

# Python 의존성 설치
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# 앱 코드 복사 (backend/app → /app/app)
COPY app ./app

# FastAPI 포트
EXPOSE 8000

# ⚠ 엔트리포인트는 실제 구조에 맞게 수정 필요
# 예: backend/app/main.py 안에 app = FastAPI() 가 있다고 가정
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
